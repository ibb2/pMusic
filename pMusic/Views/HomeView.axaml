<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             xmlns:vm="clr-namespace:pMusic.ViewModels"
             xmlns:converter="clr-namespace:pMusic.Converter"
             xmlns:behaviours="clr-namespace:pMusic.Behaviours"
             xmlns:shadui="clr-namespace:ShadUI;assembly=ShadUI"
             x:Class="pMusic.Views.HomeView"
             x:DataType="vm:HomeViewModel">
    <Design.DataContext>
        <!-- This only sets the DataContext for the previewer in an IDE,
         to set the actual DataContext for runtime, set the DataContext property in code (look at App.axaml.cs) -->
        <vm:HomeViewModel />
    </Design.DataContext>
    <UserControl.Resources>
        <converter:Thumbnail x:Key="ThumbnailToBitmapConverter" />
    </UserControl.Resources>
    <UserControl.Styles>
        <Style>
            <Style Selector="TextBlock.h2">
                <Setter Property="FontSize" Value="22"></Setter>
                <Setter Property="FontWeight" Value="SemiBold"></Setter>
            </Style>
        </Style>
    </UserControl.Styles>
    <Grid RowDefinitions="Auto,Auto,Auto,Auto" HorizontalAlignment="Stretch">
        <!-- Filters for library type (Music, Podcats, Audiobooks, etc) -->
        <!-- Recently Played -->
        <ItemsControl
            Grid.Row="0"
            Margin="0 32"
            ItemsSource="{Binding TopEight}"
            HorizontalAlignment="Stretch">
            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <Grid
                        behaviours:ResponsiveGridBehavior.IsEnabled="True"
                        ColumnDefinitions="*,*,*,*"
                        RowDefinitions="Auto, Auto">
                    </Grid>
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <Button
                        Command="{Binding $parent[ItemsControl].((vm:HomeViewModel)DataContext).GoToAlbumPageCommand}"
                        CommandParameter="{Binding Album}"
                        Margin="4"
                        CornerRadius="8"
                        BorderThickness="0"
                        Padding="0"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Stretch"
                        HorizontalContentAlignment="Stretch"
                        MinWidth="150"
                        Height="60"
                        shadui:ElementAssist.Classes="Secondary">
                        <Grid ColumnDefinitions="Auto, *" HorizontalAlignment="Stretch">
                            <Border Width="60" Height="60"
                                    CornerRadius="8,0,0,8"
                                    ClipToBounds="True">
                                <Image Source="{Binding Image}" Stretch="UniformToFill" />
                            </Border>
                            <TextBlock Grid.Column="1"
                                       Text="{Binding Title}"
                                       Margin="12,0,12,0"
                                       FontWeight="Bold"
                                       TextWrapping="NoWrap"
                                       TextTrimming="CharacterEllipsis"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Left" />
                        </Grid>
                    </Button>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
        <StackPanel Grid.Row="1" Margin="0 0 0 24" Spacing="4">
            <TextBlock Classes="h2">Recently Played</TextBlock>
            <!-- New Releases / Recently Added? -->
            <ScrollViewer HorizontalScrollBarVisibility="Hidden">
                <ItemsControl ItemsSource="{Binding  Albums}"
                              ScrollViewer.HorizontalScrollBarVisibility="Hidden">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Horizontal" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Button
                                shadui:ElementAssist.Classes="Ghost"
                                Command="{Binding $parent.((vm:HomeViewModel)DataContext).GoToAlbumPageCommand}"
                                CommandParameter="{Binding Album}"
                                Height="225"
                                Padding="4 2" VerticalAlignment="Center" VerticalContentAlignment="Center">
                                <shadui:Card
                                    HorizontalAlignment="Center"
                                    HasShadow="True" Padding="16" Height="215" MaxWidth="175">
                                    <StackPanel Spacing="12">
                                        <StackPanel>
                                            <Border Width="175" Height="125" CornerRadius="4" ClipToBounds="True"
                                                    BorderThickness="1" HorizontalAlignment="Center">
                                                <Rectangle RadiusX="4" RadiusY="4">
                                                    <Rectangle.Fill>
                                                        <ImageBrush Source="{Binding Image}" Stretch="UniformToFill" />
                                                    </Rectangle.Fill>
                                                </Rectangle>
                                            </Border>
                                        </StackPanel>
                                        <StackPanel Spacing="4">
                                            <TextBlock Text="{Binding Title}" TextWrapping="NoWrap"
                                                       TextTrimming="CharacterEllipsis" FontWeight="SemiBold"
                                                       FontSize="14" />
                                            <TextBlock Text="{Binding Album.Artist.Title}"
                                                       TextWrapping="NoWrap"
                                                       TextTrimming="CharacterEllipsis" FontSize="12"
                                                       FontWeight="Light" />
                                        </StackPanel>
                                    </StackPanel>
                                </shadui:Card>
                            </Button>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                    <ItemsControl.Styles>
                        <Style Selector="ListBoxItem">
                            <Setter Property="Padding" Value="0" />
                            <Setter Property="Margin" Value="0" />
                        </Style>
                    </ItemsControl.Styles>
                </ItemsControl>
            </ScrollViewer>
        </StackPanel>
        <StackPanel Grid.Row="2" Margin="0 0 0 24" Spacing="4">
            <TextBlock Classes="h2">Recently Added</TextBlock>
            <!-- New Releases / Recently Added? -->
            <ScrollViewer HorizontalScrollBarVisibility="Hidden">
                <ItemsControl ItemsSource="{Binding  RecentlyAddedAlbums}"
                              ScrollViewer.HorizontalScrollBarVisibility="Hidden">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Horizontal" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Button
                                shadui:ElementAssist.Classes="Ghost"
                                Command="{Binding $parent.((vm:HomeViewModel)DataContext).GoToAlbumPageCommand}"
                                CommandParameter="{Binding Album}"
                                Height="225"
                                Padding="4 2" VerticalAlignment="Center" VerticalContentAlignment="Center">
                                <shadui:Card
                                    HorizontalAlignment="Center"
                                    HasShadow="True" Padding="16" Height="215" MaxWidth="175">
                                    <StackPanel Spacing="12">
                                        <StackPanel>
                                            <Border Width="175" Height="125" CornerRadius="4" ClipToBounds="True"
                                                    BorderThickness="1" HorizontalAlignment="Center">
                                                <Rectangle RadiusX="4" RadiusY="4">
                                                    <Rectangle.Fill>
                                                        <ImageBrush Source="{Binding Image}" Stretch="UniformToFill" />
                                                    </Rectangle.Fill>
                                                </Rectangle>
                                            </Border>
                                        </StackPanel>
                                        <StackPanel Spacing="4">
                                            <TextBlock Text="{Binding Title}" TextWrapping="NoWrap"
                                                       TextTrimming="CharacterEllipsis" FontWeight="SemiBold"
                                                       FontSize="14" />
                                            <TextBlock Text="{Binding Album.Artist.Title}"
                                                       TextWrapping="NoWrap"
                                                       TextTrimming="CharacterEllipsis" FontSize="12"
                                                       FontWeight="Light" />
                                        </StackPanel>
                                    </StackPanel>
                                </shadui:Card>
                            </Button>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                    <ItemsControl.Styles>
                        <Style Selector="ListBoxItem">
                            <Setter Property="Padding" Value="0" />
                            <Setter Property="Margin" Value="0" />
                        </Style>
                    </ItemsControl.Styles>
                </ItemsControl>
            </ScrollViewer>
        </StackPanel>
        <StackPanel Grid.Row="3" Margin="0 0 0 24" Spacing="4">
            <!-- Uniquely Yours -->
            <TextBlock Classes="h2">Uniquely Yours</TextBlock>
            <!-- Playlists (and other auto-generated information) -->
            <ScrollViewer HorizontalScrollBarVisibility="Hidden">
                <ItemsControl ItemsSource="{Binding  Playlists}"
                              ScrollViewer.HorizontalScrollBarVisibility="Hidden">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Horizontal" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Button
                                shadui:ElementAssist.Classes="Ghost"
                                Command="{Binding $parent.((vm:HomeViewModel)DataContext).GoToPlaylistPageCommand}"
                                CommandParameter="{Binding Playlist}"
                                Height="225"
                                Padding="4 2" VerticalAlignment="Center"
                                VerticalContentAlignment="Center">

                                <shadui:Card
                                    HorizontalAlignment="Center"
                                    HasShadow="True" Padding="16" Height="215" MaxWidth="175">
                                    <StackPanel Spacing="12">
                                        <StackPanel>
                                            <Border Width="175" Height="125" CornerRadius="4" ClipToBounds="True"
                                                    BorderThickness="1" HorizontalAlignment="Center">
                                                <Rectangle RadiusX="4" RadiusY="4">
                                                    <Rectangle.Fill>
                                                        <ImageBrush Source="{Binding Composite}"
                                                                    Stretch="UniformToFill" />
                                                    </Rectangle.Fill>
                                                </Rectangle>
                                            </Border>
                                        </StackPanel>
                                        <StackPanel Spacing="4">
                                            <TextBlock Text="{Binding Title}" TextWrapping="NoWrap"
                                                       TextTrimming="CharacterEllipsis" FontWeight="SemiBold"
                                                       FontSize="14" />
                                            <TextBlock Text="{Binding Duration}"
                                                       TextWrapping="NoWrap"
                                                       TextTrimming="CharacterEllipsis" FontSize="12"
                                                       FontWeight="Light" />
                                        </StackPanel>
                                    </StackPanel>
                                </shadui:Card>
                            </Button>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                    <ItemsControl.Styles>
                        <Style Selector="ListBoxItem">
                            <Setter Property="Padding" Value="0" />
                            <Setter Property="Margin" Value="0" />
                        </Style>
                    </ItemsControl.Styles>
                </ItemsControl>
            </ScrollViewer>
        </StackPanel>
    </Grid>
</UserControl>